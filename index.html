<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Annotiertes Video</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        .container {
            display: flex;
            height: 100vh;
            width: 100vw;
        }

        .video-container {
            flex: 1;
            position: relative;
        }

        .video-container iframe {
            width: 100%;
            height: 100%;
        }

        .sidebar {
            width: 400px;
            background: #1a1a1a;
            color: white;
            overflow-y: auto;
            padding: 20px;
        }

        .annotation {
            margin-bottom: 20px;
            padding: 15px;
            border-left: 3px solid #4CAF50;
            background: #2a2a2a;
            cursor: pointer;
            transition: all 0.3s;
        }

        .annotation:hover {
            background: #3a3a3a;
        }

        .annotation.active {
            border-left-color: #ff4444;
            background: #3a2a2a;
        }

        .timestamp {
            color: #4CAF50;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .original-text {
            font-style: italic;
            margin-bottom: 10px;
            color: #ccc;
        }

        .enhancement {
            margin-bottom: 10px;
        }

        .citations {
            font-size: 0.9em;
            color: #888;
        }
    </style>
</head>
<body>
<div class="container">
    <div class="video-container">
        <iframe allowfullscreen
                frameborder="0"
                id="video-iframe"
                src="https://www.youtube.com/embed/-wpnNhdADsE?enablejsapi=1">
        </iframe>
    </div>

    <div class="sidebar" id="sidebar">
        <!-- Annotationen werden hier dynamisch eingefügt -->
    </div>
</div>

<script src="https://www.youtube.com/iframe_api"></script>
<script>
    // Deine Annotationsdaten
    const raw = {
        "video_annotations": {
            "metadata": {
                "video_title": "Japan Lauf-Reise - Tag 24-26",
                "language": "Deutsch",
                "annotation_focus": "Philosophische und motivationale Inhaltsverbesserung"
            },
            "annotations": [
                {
                    "timestamp": "7:37",
                    "original_text": "ich habe jeden Tag die Entscheidung zu sagen bleibe ich liegen chill jetzt noch oder gehe ich raus und mach das was ich tun muss",
                    "annotation": "Dies berührt Sartres Konzept der radikalen Freiheit und Verantwortung. Jeder Moment präsentiert das, was Existentialisten 'die fundamentale Wahl' nennen.",
                    "enhancement": "Der Sprecher identifiziert das zentrale existentialistische Dilemma - was Sartre 'être-pour-soi' (Sein-für-sich) nannte. Diese täglich Wahl repräsentiert das, was Viktor Frankl 'die letzte menschliche Freiheit' nannte - die Fähigkeit, seine Haltung in jeder Situation zu wählen.",
                    "citations": ["Sartre, J.P. 'Das Sein und das Nichts' (1943)", "Frankl, V. 'Die Suche des Menschen nach Sinn' (1946)"],
                    "philosophical_depth": 8
                },
                {
                    "timestamp": "8:32",
                    "original_text": "ich weiß wie es sich anfühlt wenn man seine Arbeit verrichtet hat und dieses Zufriedenheitsgefühl",
                    "annotation": "Verweist auf das Konzept der 'Eudaimonia' - Erfüllung durch tugendhaftes Handeln statt hedonistische Freude.",
                    "enhancement": "Dies beschreibt das, was Aristoteles 'Eudaimonia' nannte - die tiefe Zufriedenheit, die aus der Verwirklichung des eigenen Potentials entsteht. Die moderne Psychologie validiert dies als 'intrinsische Motivation' (Deci & Ryans Selbstbestimmungstheorie).",
                    "citations": ["Aristoteles, 'Nikomachische Ethik'", "Deci, E.L. & Ryan, R.M. 'Selbstbestimmungstheorie' (1985)"],
                    "philosophical_depth": 7
                },
                {
                    "timestamp": "9:43",
                    "original_text": "es wird nie eine Abkürzung geben nie gewöhnt euch dran die Treppe zu nehmen",
                    "annotation": "Spiegelt stoische Philosophie über die Notwendigkeit des Kampfes für Charakterentwicklung wider.",
                    "enhancement": "Dies stimmt mit dem stoischen Prinzip überein, dass Hindernisse der Weg selbst sind. Marcus Aurelius schrieb: 'Das Hindernis für Handlung fördert Handlung. Was im Weg steht, wird zum Weg.' Moderne Forschung zu 'posttraumatischem Wachstum' stützt diese antike Weisheit.",
                    "citations": ["Marcus Aurelius, 'Selbstbetrachtungen'", "Tedeschi, R.G. & Calhoun, L.G. 'Posttraumatisches Wachstum' (2004)"],
                    "philosophical_depth": 9
                },
                {
                    "timestamp": "11:02",
                    "original_text": "es ist ein Naturgesetz dass wenn du Gas gibst und wirklich aus dem Herzen heraus 100% gibst",
                    "annotation": "Behauptet Naturgesetzes-Status für Anstrengung-Belohnung-Korrelation - benötigt Nuancierung.",
                    "enhancement": "Während Anstrengung oft mit Ergebnissen korreliert, vereinfacht die Bezeichnung als 'Naturgesetz' komplexe Systeme. Nassim Talebs Arbeit über Zufälligkeit und der 'Gerecht-Welt-Fehlschluss' in der Psychologie zeigen, dass diese Beziehung eher probabilistisch als deterministisch ist.",
                    "citations": ["Taleb, N.N. 'Der Schwarze Schwan' (2001)", "Lerner, M.J. 'Der Glaube an eine gerechte Welt' (1980)"],
                    "philosophical_depth": 6,
                    "correction": "Die Behauptung des Sprechers benötigt Abschwächung durch Anerkennung systemischer Faktoren und Zufälligkeit."
                },
                {
                    "timestamp": "13:50",
                    "original_text": "fokussiert dich in eurem Leben immer auf Kontinuität nicht auf die Perfektion",
                    "annotation": "Stellt Perfektionismus zugunsten konstanten Fortschritts in Frage - psychologisch validierter Ansatz.",
                    "enhancement": "Dies stimmt mit Forschung zu 'Implementierungsabsichten' und 'Gewohnheitsbildung' überein. Der Sprecher erfasst intuitiv das, was Brené Brown 'Perfektionismus als Feind des Fortschritts' nennt und was James Clear 'atomare Gewohnheiten' bezeichnet.",
                    "citations": ["Gollwitzer, P.M. 'Implementierungsabsichten' (1999)", "Clear, J. 'Die 1%-Methode' (2018)", "Brown, B. 'Die Gaben der Unperfektion' (2010)"],
                    "philosophical_depth": 8
                }
            ],
            "essay_synthesis": {
                "introduction": "Dieses Video enthält mehrere tiefgreifende philosophische Einsichten über menschliche Motivation, Handlungsfähigkeit und Selbstentwicklung, obwohl einige Behauptungen von Nuancierung durch zeitgenössische Forschung und breitere philosophische Perspektiven profitieren würden.",
                "main_themes": [
                    "Existentialistische Wahl und radikale Freiheit",
                    "Die Natur der Erfüllung und Eudaimonia",
                    "Stoische Akzeptanz notwendiger Kämpfe",
                    "Authentizität versus Nachahmung",
                    "Prozess- versus Ergebnisorientierung",
                    "Individuelle Handlungsfähigkeit versus systemische Faktoren"
                ],
                "conclusion": "Der Sprecher demonstriert intuitives Verständnis vieler philosophischer und psychologischer Prinzipien, obwohl die individualistische Rahmung durch Anerkennung gemeinschaftlicher und systemischer Dimensionen menschlichen Aufblühens bereichert werden könnte."
            }
        }
    };

    function parseTimestamp(timestamp) {
        const parts = timestamp.split(':');
        if (parts.length === 2) {
            return parseInt(parts[0]) * 60 + parseInt(parts[1]);
        } else if (parts.length === 3) {
            return parseInt(parts[0]) * 3600 + parseInt(parts[1]) * 60 + parseInt(parts[2]);
        }
        return 0;
    }

    const annotations = raw.video_annotations.annotations.map(({timestamp, ...rest}) => {
        return {
            ...rest,
            timestamp,
            timestampSeconds: parseTimestamp(timestamp)
        };
    });
    let player;
    let isPaused = false;

    // YouTube Player initialisieren
    function onYouTubeIframeAPIReady() {
        player = new YT.Player('video-iframe', {
            events: {
                'onReady': onPlayerReady,
                'onStateChange': onPlayerStateChange
            }
        });
    }

    function onPlayerReady(event) {
        renderAnnotations();
        trackVideoProgress();
    }

    function onPlayerStateChange(event) {
        // Player state tracking
    }

    // Annotationen rendern
    function renderAnnotations() {
        const sidebar = document.getElementById('sidebar');

        annotations.forEach((annotation, index) => {
            const div = document.createElement('div');
            div.className = 'annotation';
            div.setAttribute('data-time', annotation.timestampSeconds);

            div.innerHTML = `
                    <div class="timestamp">${annotation.timestamp}</div>
                    <div class="original-text">"${annotation.original_text}"</div>
                    <div class="enhancement">${annotation.enhancement}</div>
                    <div class="citations">${annotation.citations.join(', ')}</div>
                `;

            // Click handler für Zeitsprung
            div.addEventListener('click', () => {
                player.seekTo(annotation.timestampSeconds);
            });

            sidebar.appendChild(div);
        });
    }

    // Video Progress tracking
    function trackVideoProgress() {
        setInterval(() => {
            if (player && player.getCurrentTime) {
                const currentTime = player.getCurrentTime();
                highlightCurrentAnnotation(currentTime);
            }
        }, 1000);
    }

    // Aktuelle Annotation hervorheben
    function highlightCurrentAnnotation(currentTime) {
        const annotationElements = document.querySelectorAll('.annotation');

        annotationElements.forEach(el => {
            const annotationTime = parseInt(el.getAttribute('data-time'));

            if (Math.abs(currentTime - annotationTime) < 30) { // 30 Sekunden Toleranz
                el.classList.add('active');
            } else {
                el.classList.remove('active');
            }
        });
    }

    // Sidebar hover = Video pausieren
    document.getElementById('sidebar').addEventListener('mouseenter', () => {
        if (player && player.getPlayerState() === YT.PlayerState.PLAYING) {
            player.pauseVideo();
            isPaused = true;
        }
    });

    document.getElementById('sidebar').addEventListener('mouseleave', () => {
        if (player && isPaused) {
            player.playVideo();
            isPaused = false;
        }
    });
</script>
</body>
</html>
